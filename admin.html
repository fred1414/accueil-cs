<!DOCTYPE html> 
<html lang="fr">

</style>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
<title>Administration -- CS VER</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
  *{box-sizing:border-box;font-family:'Inter',sans-serif;margin:0;padding:0}
  body{background:#f5f5f5;padding:30px;color:#222;}
  h1{text-align:center;margin-bottom:20px;color:#d32f2f;position:relative;}
  .container{max-width:1100px;margin:auto;background:#fff;border-radius:12px;padding:25px 30px;box-shadow:0 10px 25px rgba(0,0,0,0.1);}
  .top-bar{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;}
  .right-actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .search-box input{padding:8px 12px;border:1px solid #ccc;border-radius:6px;width:280px;font-size:15px;}
  table{width:100%;border-collapse:collapse;margin-top:15px;}
  th,td{border:1px solid #ddd;padding:10px;text-align:left;vertical-align:top;}
  th{background:#004aad;color:#fff;}
  tr:nth-child(even){background:#f9f9f9;}
  tr:hover{background:#e3f2fd;}
  button{padding:8px 14px;margin:4px;border:none;border-radius:6px;cursor:pointer;font-weight:600;}
  .btn-primary{background:#004aad;color:#fff;}
  .btn-edit{background:#ff9800;color:#fff;}
  .btn-delete{background:#d32f2f;color:#fff;}
  .btn-close{background:#6c757d;color:#fff;}
  .btn-ghost{background:#eef2ff;color:#233;}
  .form-box{margin-top:30px;background:#fafafa;border:1px solid #ddd;border-radius:8px;padding:20px;}
  .inline-box{margin-top:12px;background:#f7f9ff;border:1px solid #cfd7ff;border-radius:8px;padding:12px;}
  label{font-weight:600;margin-top:8px;display:block;}
  input,select{width:100%;padding:8px;margin-top:4px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;}
  footer{text-align:center;margin-top:20px;color:#888;}
  .back-btn{position:absolute;top:20px;right:30px;background:#d32f2f;color:#fff;border:none;border-radius:30px;padding:8px 18px;font-weight:600;cursor:pointer;transition:background .2s;}
  .back-btn:hover{background:#b71c1c;}
  .hint{font-size:12px;color:#666;margin-top:-6px;margin-bottom:8px}
  .cis-wrap{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:700px){.cis-wrap{grid-template-columns:1fr}}
  .modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:flex-start;
  justify-content:center;
  padding:20px;
  overflow:auto;
  z-index:9999;
}

.modal .panel{
  background:#fff;
  border-radius:12px;
  max-width:1100px;
  width:100%;
  padding:18px 20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.25);
  max-height:calc(100vh - 40px);
  overflow-y:auto;
}

.modal h3{margin-bottom:8px;color:#004aad}
.modal .topline{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:space-between;margin-bottom:8px}
.modal .search{flex:1;min-width:260px}
.modal .muted{font-size:12px;color:#666}
.perm-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:8px;margin-top:6px}
.perm-grid label{display:flex;gap:8px;align-items:center;font-weight:500;margin:0}
.perm-title{font-weight:700;margin:8px 0 6px;color:#004aad}
select:disabled, input:disabled { background:#eee !important; color:#666 !important; cursor:not-allowed; }
</style>
</head>

<body>

<button class="back-btn" onclick="window.location.href='index.html'">? Retour</button>

<h1>? Gestion des utilisateurs -- CISMIC</h1>

<div class="container">
  <div class="top-bar">
    <h2>Liste des utilisateurs</h2>
    <div class="right-actions">
      <div class="search-box">? <input type="text" id="search" placeholder="Rechercher (matricule, nom, prénom, statut ou CIS)..."></div>
      <button id="dirBtn" class="btn-ghost" style="display:none" onclick="openDirectory()">? Répertoire agents</button>
      <button class="btn-primary" onclick="showForm()">? Nouvel utilisateur</button>
    </div>
  </div>

  <table id="userTable">
    <thead>
      <tr>
        <th>Matricule</th>
        <th>Nom</th>
        <th>Prénom</th>
        <th>Statut (CIS principal)</th>
        <th>Affectations CIS</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="userList"></tbody>
  </table>

  <!-- le reste du JS métier que tu as collé continue ici -->
</div>

<footer>© CISMIC -- Administration 2025</footer>

<!-- ? Firebase + Firestore + stockage partagé -->
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore-compat.js"></script>
<script src="cloud-storage.js"></script>

</body>
</html>
